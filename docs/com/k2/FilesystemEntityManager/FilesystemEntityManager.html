<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_25) on Wed Jan 10 17:58:59 GMT 2018 -->
<title>FilesystemEntityManager</title>
<meta name="date" content="2018-01-10">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="FilesystemEntityManager";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../com/k2/FilesystemEntityManager/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/FilesystemEntityManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/k2/FilesystemEntityManager/FemWrapperDeserializer.html" title="class in com.k2.FilesystemEntityManager"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManagerFactory.html" title="class in com.k2.FilesystemEntityManager"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/k2/FilesystemEntityManager/FilesystemEntityManager.html" target="_top">Frames</a></li>
<li><a href="FilesystemEntityManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.k2.FilesystemEntityManager</div>
<h2 title="Class FilesystemEntityManager" class="title">Class FilesystemEntityManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.k2.FilesystemEntityManager.FilesystemEntityManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">FilesystemEntityManager</span>
extends java.lang.Object</pre>
<div class="block">This class defines the thread specific entity manager that provides the API to fetch, save and delete instances of objects into and out of 
 repositories on the file system.
 
 Instances of FileSystemEntityManager can only be created through the connect() method of an instance of the FileSystemEntityManagerFactory.
 
 Object instance data is held on the file system in repositories. A repository can hold instances of multiple object classes by defining a
 repository path for each class that identifies the path within the repository in which to store instance data for objects of the class.
 
 The actual repository and format of the file system resource that persists the instance data for any given class is defined in the 
 configuration of the FileSystemEntityManagerFactory that created this entity manager.
 
 The entity manager is not thread safe and therefore should only be used within the context of a single thread.
 
 The entity manager holds a cache of the objects that are managed by this entity manager. This prevents unnecessary disk reads.
 
 Attempts to alter the same instance data by different threads is managed through the FileLock API and therefore any system
 that writes data to the repositories must make use of the file systems locking architecture in order to not conflict with the file system entity manager.
 
 The entity manager manages objects using an Object Change Number (OCN) to identify that the objects instance data has changed if the object is
 stored in the repository in a wrapper. If the OCN of an object when it is being saved is not the same as the OCN of the object when the object was
 fetched then the entity manager will throw a mutated object exception to inform the calling process that the save action has failed and that the 
 object should be re-fetched into the entity manager and the changes to the object remade. If it is not stored in a wrapper then the MD5 hash of the file 
 holding the objects instance data is calculated when the object is fetched and compared to the MD5 hash of the current file in the repository holding
 the instance data. If the MD5 hashes are not the same then a mutated object exception is thrown when the object is saved.
 
 When an object is saved the a version of the file holding the objects instance data is created on the file system but in a working directory specific to the 
 entity manager that is making the change.  This minimises the chance of IOExceptions when committing changes. The object instances data is successfully 
 written to the entity managers working directory only if it passes the locking, mutation and duplicate keys tests and when the file in the repository for 
 the objec being written has been locked. When the edits are committed the files in the entity managers working directory are copied to the repository and
 the locks released.
 
 If the entity manager rolls back its changes then the files in the entity managers working directory are deleted, the locks are released and the 
 entity managers cache is cleared.
 
 If the entity manager commits its changes then the files in the entity managers working directory are moved to the relevant repositories, the locks are 
 released and the working directory is cleared. The cache however is not cleared.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>simon</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#close--">close</a></span>()</code>
<div class="block">This method closes this entity manager
 
 Any uncommitted changes are rolled back and the entity manager factory is informed that the entity manager has been closed
 All the contents of the working directory and the working directory itself is deleted</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#commit--">commit</a></span>()</code>
<div class="block">Commit the current changes managed by this entity manager to the repository</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;T</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#delete-T-">delete</a></span>(T&nbsp;obj)</code>
<div class="block">This method identifies an object as deleted in this entity manager and locks its resource in the repository to prevent other entity managers
 from updating it</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;T</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#fetch-java.lang.Class-java.io.Serializable-">fetch</a></span>(java.lang.Class&lt;T&gt;&nbsp;cls,
     java.io.Serializable&nbsp;key)</code>
<div class="block">This method fetches the persisted data for the given class and key</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#finalize--">finalize</a></span>()</code>
<div class="block">When the last reference to this entity manager is lost then the entity manager will close automatically</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#getId--">getId</a></span>()</code>
<div class="block">This method returns the 12 digit random string id of this entity manager</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>java.lang.Integer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#getOcn-java.lang.Object-">getOcn</a></span>(java.lang.Object&nbsp;obj)</code>
<div class="block">Get the OCN of the current version of the object held in this entity managers cache for the given object</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>java.lang.Integer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#getOriginalOcn-java.lang.Object-">getOriginalOcn</a></span>(java.lang.Object&nbsp;obj)</code>
<div class="block">Get the OCN for the given object identified when the object was fetched into this entity managers cache of attached objects</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#rollback--">rollback</a></span>()</code>
<div class="block">Discard all the changes currently managed by this entity manager and release all the locks held by this entity manager</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;T</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManager.html#save-T-">save</a></span>(T&nbsp;obj)</code>
<div class="block">Save the given object in the repository appropriate for the class of the object to save</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getId--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getId</h4>
<pre>public&nbsp;java.lang.String&nbsp;getId()</pre>
<div class="block">This method returns the 12 digit random string id of this entity manager</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The 12 digit string id of this entity manager</dd>
</dl>
</li>
</ul>
<a name="getOcn-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOcn</h4>
<pre>public&nbsp;java.lang.Integer&nbsp;getOcn(java.lang.Object&nbsp;obj)</pre>
<div class="block">Get the OCN of the current version of the object held in this entity managers cache for the given object</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>obj</code> - The object for which to get the OCN</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The OCN of the given object in this entity managers cache of attached objects. null if the object is
 null or not cached by this entity manager.</dd>
</dl>
</li>
</ul>
<a name="getOriginalOcn-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOriginalOcn</h4>
<pre>public&nbsp;java.lang.Integer&nbsp;getOriginalOcn(java.lang.Object&nbsp;obj)</pre>
<div class="block">Get the OCN for the given object identified when the object was fetched into this entity managers cache of attached objects</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>obj</code> - for which to extract the original OCN from this entity managers cache</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The original OCN of the object when it was fetched into this entity managers cache</dd>
</dl>
</li>
</ul>
<a name="fetch-java.lang.Class-java.io.Serializable-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fetch</h4>
<pre>public&nbsp;&lt;T&gt;&nbsp;T&nbsp;fetch(java.lang.Class&lt;T&gt;&nbsp;cls,
                   java.io.Serializable&nbsp;key)</pre>
<div class="block">This method fetches the persisted data for the given class and key</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - The type of the object to fetch</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cls</code> - The class of the object to fetch</dd>
<dd><code>key</code> - The key identifying the object to fetch</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The instance of the given class with the given key. If the class and key do not identify a persisted instance of the given
 class a null is returned</dd>
</dl>
</li>
</ul>
<a name="save-java.lang.Object-">
<!--   -->
</a><a name="save-T-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>save</h4>
<pre>public&nbsp;&lt;T&gt;&nbsp;T&nbsp;save(T&nbsp;obj)
           throws <a href="../../../com/k2/FilesystemEntityManager/FemObjectLockedException.html" title="class in com.k2.FilesystemEntityManager">FemObjectLockedException</a>,
                  <a href="../../../com/k2/FilesystemEntityManager/FemDuplicateKeyException.html" title="class in com.k2.FilesystemEntityManager">FemDuplicateKeyException</a>,
                  <a href="../../../com/k2/FilesystemEntityManager/FemMutatedObjectException.html" title="class in com.k2.FilesystemEntityManager">FemMutatedObjectException</a></pre>
<div class="block">Save the given object in the repository appropriate for the class of the object to save</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - The type of the object to save</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>obj</code> - The object to save</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The object that was saved and cached in this entity managers cache of attached objects</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../com/k2/FilesystemEntityManager/FemObjectLockedException.html" title="class in com.k2.FilesystemEntityManager">FemObjectLockedException</a></code> - If the object is locked by another entity manager instance</dd>
<dd><code><a href="../../../com/k2/FilesystemEntityManager/FemDuplicateKeyException.html" title="class in com.k2.FilesystemEntityManager">FemDuplicateKeyException</a></code> - If the object is not attached to this entity manager and already exists in the the 
                                                                                relevant repository</dd>
<dd><code><a href="../../../com/k2/FilesystemEntityManager/FemMutatedObjectException.html" title="class in com.k2.FilesystemEntityManager">FemMutatedObjectException</a></code> - If the object has been saved and committed by another entity manager since this object
                                                                                was fetched into this entity managers cache of attached objects</dd>
</dl>
</li>
</ul>
<a name="delete-java.lang.Object-">
<!--   -->
</a><a name="delete-T-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>delete</h4>
<pre>public&nbsp;&lt;T&gt;&nbsp;T&nbsp;delete(T&nbsp;obj)
             throws <a href="../../../com/k2/FilesystemEntityManager/FemObjectLockedException.html" title="class in com.k2.FilesystemEntityManager">FemObjectLockedException</a></pre>
<div class="block">This method identifies an object as deleted in this entity manager and locks its resource in the repository to prevent other entity managers
 from updating it</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - The type of the object to delete</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>obj</code> - The object to delete</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The object that has been identified as deleted</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../com/k2/FilesystemEntityManager/FemObjectLockedException.html" title="class in com.k2.FilesystemEntityManager">FemObjectLockedException</a></code> - If this object has been locked by another entity manager</dd>
</dl>
</li>
</ul>
<a name="commit--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre>public&nbsp;void&nbsp;commit()</pre>
<div class="block">Commit the current changes managed by this entity manager to the repository</div>
</li>
</ul>
<a name="rollback--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rollback</h4>
<pre>public&nbsp;void&nbsp;rollback()</pre>
<div class="block">Discard all the changes currently managed by this entity manager and release all the locks held by this entity manager</div>
</li>
</ul>
<a name="close--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;close()</pre>
<div class="block">This method closes this entity manager
 
 Any uncommitted changes are rolled back and the entity manager factory is informed that the entity manager has been closed
 All the contents of the working directory and the working directory itself is deleted</div>
</li>
</ul>
<a name="finalize--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>finalize</h4>
<pre>public&nbsp;void&nbsp;finalize()</pre>
<div class="block">When the last reference to this entity manager is lost then the entity manager will close automatically</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code>finalize</code>&nbsp;in class&nbsp;<code>java.lang.Object</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../com/k2/FilesystemEntityManager/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/FilesystemEntityManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/k2/FilesystemEntityManager/FemWrapperDeserializer.html" title="class in com.k2.FilesystemEntityManager"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../com/k2/FilesystemEntityManager/FilesystemEntityManagerFactory.html" title="class in com.k2.FilesystemEntityManager"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/k2/FilesystemEntityManager/FilesystemEntityManager.html" target="_top">Frames</a></li>
<li><a href="FilesystemEntityManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
